{% extends 'settings_base.html' %}

{% block settings_title %}Profile Settings{% endblock %}

{% block settings_content %}
<h2 class="text-2xl font-bold text-white mb-8">General Profile</h2>

<form method="post" enctype="multipart/form-data" class="space-y-8">
    {% csrf_token %} {# Important for security #}

    <div class="pb-8 border-b border-white/10">
        <h3 class="text-lg font-semibold text-gray-200 mb-4">Profile Picture</h3>
        <div class="flex items-center gap-6">
            {% if user.profile.avatar %}
                <img src="{{ user.profile.avatar.url }}" alt="Current Avatar" class="w-24 h-24 rounded-full object-cover border-2 border-white/20">
            {% else %}
                <div class="w-24 h-24 rounded-full bg-indigo-900 flex items-center justify-center border-2 border-white/20">
                    <span class="text-3xl font-bold text-indigo-300">{{ user.username|first|upper }}</span>
                </div>
            {% endif %}
            <div>
                <label for="avatar-upload" class="cursor-pointer bg-white/10 hover:bg-white/20 text-white font-semibold py-2 px-4 rounded-lg transition-colors">
                    Upload New Picture
                </label>
                <input type="file" name="avatar" id="avatar-upload" class="hidden">
                <p class="text-sm text-gray-400 mt-2">PNG or JPG. Max size of 5MB.</p>
            </div>
        </div>
    </div>

    <div class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6">
            <div>
                <label for="first_name" class="block text-gray-300 mb-2">First Name</label>
                <input type="text" id="first_name" name="firstname" value="{{ user.profile.firstname }}" class="form-input-themed w-full py-2 px-3">
            </div>
            <div>
                <label for="last_name" class="block text-gray-300 mb-2">Last Name</label>
                <input type="text" id="last_name" name="lastname" value="{{ user.profile.lastname }}" class="form-input-themed w-full py-2 px-3">
            </div>
        </div>
        
        <div>
            <label for="username" class="block text-gray-300 mb-2">Username</label>
            <input type="text" id="username" name="username" value="{{ user.username }}" disabled class="form-input-themed w-full py-2 px-3 bg-white/5 opacity-60 cursor-not-allowed">
        </div>
        
        <div>
            <label for="location" class="block text-gray-300 mb-2">Location</label>
            <input type="text" id="location" name="location" value="{{ user.profile.location }}" placeholder="e.g., Tehran" class="form-input-themed w-full py-2 px-3">
        </div>

        <div>
            <label for="bio" class="block text-gray-300 mb-2">Bio</label>
            <textarea id="bio" name="bio" rows="4" placeholder="Tell us a little about yourself..." class="form-input-themed w-full py-2 px-3">{{ user.profile.bio }}</textarea>
        </div>
    </div>

    <div class="pt-8 border-t border-white/10">
        <h3 class="text-lg font-semibold text-gray-200 mb-4">I want to practice...</h3>
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-4">
            {% with interests="speaking,reading,writing,listening" %}
            {% for interest in interests.split(',') %}
            <label for="interest-{{ interest }}" class="flex items-center gap-3 p-3 rounded-lg bg-white/5 hover:bg-white/10 cursor-pointer transition-colors">
                <input type="checkbox" id="interest-{{ interest }}" name="learning_interest" value="{{ interest }}"
                       class="w-5 h-5 text-indigo-500 bg-gray-700 border-gray-600 rounded focus:ring-indigo-600 ring-offset-gray-800 focus:ring-2"
                       {% if interest in user.profile.learning_interest %}checked{% endif %}>
                <span class="text-white capitalize">{{ interest }}</span>
            </label>
            {% endfor %}
            {% endwith %}
        </div>
    </div>

    <div class="flex justify-end pt-8">
        <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-lg transition-colors">
            Update Profile
        </button>
    </div>
</form>
{% endblock %}